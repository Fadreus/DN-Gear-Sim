{"version":3,"sources":["simplerreader.js","dntreader.js","dntranslations.js"],"names":["SimplerReader","pFile","startPos","littleEndian","this","pos","file","DataView","readUint16","getUint16","readUint32","getUint32","readInt32","getInt32","readFloat32","getFloat32","readByte","getUint8","readString","len","String","fromCharCode","strings","Array","c","join","skipUint16","skipUint32","skipInt32","skipFloat32","skipByte","skipString","DntReader","unzipBlob","blob","callback","zip","createReader","BlobReader","zipReader","getEntries","entries","getData","BlobWriter","data","close","onerror","message","console","error","columnNames","columnTypes","columnIndexes","numRows","numColumns","fileName","colsToLoad","processFile","arrayBuffer","start","Date","getTime","reader","readFuncs","skipFuncs","colReaders","colIsRead","colIndex","realNumCols","colName","substr","colType","r","id","end","time","log","getRow","index","convertData","d","item","getValue","loadDntFromServerFile","statusFunc","processFileFunc","failFunc","useFileName","toUpperCase","lastIndexOf","length","loadDntFromServerFileImpl","isLzJson","xhr","XMLHttpRequest","open","responseType","t","onload","e","status","blobv","response","fileReader","FileReader","target","result","readAsArrayBuffer","processLzFile","unZippedData","dntFileName","zipFileName","send","stringifiedData","LZString","decompressFromUTF16","dlData","JSON","parse","DnTranslations","unzipBlobToText","TextWriter","sizeLimit","translate","value","toString","indexOf","values","split","results","v","stripped","replace","push","process","xmlFileAsString","complete","numItems","parser","DOMParser","xmlData","parseFromString","elements","getElementsByTagName","m","text","textContent","mid","getAttribute","stringify","sessionStorage","setItem","compressToUTF16","ex","stack","loadFromSession","savedData","getItem","loadDefaultFile","fail","localStorage","toLocaleString","baseFileName"],"mappings":"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","file":"dntviewer.min.js","sourcesContent":["function SimplerReader(pFile, startPos, littleEndian) {\r\n// module to track position while reading binary data\r\n'use strict';\r\n  \r\n  this.pos = startPos;\r\n  this.file = new DataView(pFile);\r\n  this.littleEndian = littleEndian;\r\n  \r\n  this.readUint16 = function() {\r\n    this.pos += 2;\r\n    return this.file.getUint16(this.pos-2, this.littleEndian);\r\n  }\r\n  \r\n  this.readUint32 = function() {\r\n    this.pos += 4;\r\n    return this.file.getUint32(this.pos-4, this.littleEndian);\r\n  }\r\n  \r\n  this.readInt32 = function() {\r\n    this.pos += 4;\r\n    return this.file.getInt32(this.pos-4, this.littleEndian);\r\n  }\r\n  \r\n  this.readFloat32 = function() {\r\n    this.pos += 4;\r\n    return this.file.getFloat32(this.pos-4, this.littleEndian);\r\n  }\r\n  \r\n  this.readByte = function() {\r\n    this.pos += 1;\r\n    return this.file.getUint8(this.pos-1, this.littleEndian);\r\n  }\r\n  \r\n  this.readString = function() {\r\n    var len = this.readUint16();\r\n    if(len === 0) {\r\n      return '';\r\n    }\r\n    else if(len === 1) {\r\n      return String.fromCharCode(this.readByte());\r\n    }\r\n    else {\r\n      \r\n      // var retVal = '';\r\n      var strings = new Array(len);\r\n      for(var c=0;c<len;++c) {\r\n        \r\n        strings[c] = String.fromCharCode(this.readByte());\r\n        // retVal += String.fromCharCode(this.readByte());\r\n      }\r\n\r\n      return strings.join('');\r\n    }\r\n  }\r\n  \r\n  this.skipUint16 = function() {\r\n    this.pos += 2;\r\n  }\r\n  \r\n  this.skipUint32 = function() {\r\n    this.pos += 4;\r\n  }\r\n  \r\n  this.skipInt32 = function() {\r\n    this.pos += 4;\r\n  }\r\n  \r\n  this.skipFloat32 = function() {\r\n    this.pos += 4;\r\n  }\r\n  \r\n  this.skipByte = function() {\r\n    this.pos += 1;\r\n  }\r\n  \r\n  this.skipString = function() {\r\n    var len = this.readUint16();\r\n    this.pos += len;\r\n  }\r\n}","function DntReader() {\r\n// module for to allow reading of dnt data from dnt files\r\n// right now this simply loads the whole file into the data property\r\n// data is an array of objects eg [{id: \"123\",NameParam: \"456\"}]\r\n'use strict';\r\n  \r\n  this.data = [];\r\n  this.columnNames = [];\r\n  this.columnTypes = [];\r\n  this.columnIndexes = [];\r\n  this.numRows = 0;\r\n  this.numColumns = 0;\r\n  this.fileName = \"\";\r\n  this.colsToLoad = null;\r\n  \r\n  // function to populate the object with the data in the dnt file\r\n  this.processFile = function(arrayBuffer, fileName) {\r\n    \r\n    var start = new Date().getTime();\r\n    \r\n    this.fileName = fileName;\r\n    \r\n    // not sure if littleEndian should always be true or when it would be false\r\n    var reader = new SimplerReader(arrayBuffer, 4, true);\r\n    \r\n    var readFuncs = [];\r\n    readFuncs[1] = function(reader) { return reader.readString() };\r\n    readFuncs[2] = function(reader) { return reader.readInt32() };\r\n    readFuncs[3] = function(reader) { return reader.readInt32() };\r\n    readFuncs[4] = function(reader) { return reader.readFloat32() };\r\n    readFuncs[5] = function(reader) { return reader.readFloat32() };\r\n    \r\n    var skipFuncs = [];\r\n    skipFuncs[1] = function(reader) { reader.skipString() };\r\n    skipFuncs[2] = function(reader) { reader.skipInt32() };\r\n    skipFuncs[3] = function(reader) { reader.skipInt32() };\r\n    skipFuncs[4] = function(reader) { reader.skipFloat32() };\r\n    skipFuncs[5] = function(reader) { reader.skipFloat32() };\r\n    \r\n    this.numColumns = reader.readUint16() + 1;\r\n    this.numRows = reader.readUint32();\r\n    \r\n    this.data = new Array(this.numRows);\r\n    this.columnNames = new Array(this.numColumns);\r\n    this.columnTypes = new Array(this.numColumns);\r\n    \r\n    this.columnNames[0] = 'id';\r\n    this.columnTypes[0] = 3;\r\n    var colReaders = [];\r\n    var colIsRead = [];\r\n    var colIndex = 1;\r\n    var realNumCols = 0;\r\n    \r\n    for(var c=1;c<this.numColumns;++c) {\r\n      var colName = reader.readString().substr(1);\r\n      var colType = reader.readByte();\r\n      \r\n      if(this.colsToLoad === null || this.colsToLoad[colName]) {\r\n        colIsRead[c] = true;\r\n        colReaders[c] = readFuncs[colType];\r\n\r\n        this.columnNames[colIndex] = colName;\r\n        this.columnTypes[colIndex] = colType;\r\n        colIndex++;\r\n      }\r\n      else {\r\n        colIsRead[c] = false;\r\n        colReaders[c] = skipFuncs[colType];\r\n      }\r\n    }\r\n    realNumCols = colIndex;\r\n    \r\n    for(var r=0;r<this.numRows;++r) {\r\n      \r\n      this.data[r] = new Array(realNumCols);\r\n      this.data[r][0] = reader.readUint32();\r\n      \r\n      colIndex = 1;\r\n      for(var c=1;c<this.numColumns;++c) {\r\n        if(colIsRead[c]) {\r\n          this.data[r][colIndex] = colReaders[c](reader);\r\n          colIndex++;\r\n        }\r\n        else {\r\n          colReaders[c](reader);\r\n        }\r\n      }\r\n    }\r\n    \r\n    this.numColumns = realNumCols;\r\n\r\n    this.columnIndexes = {'id': 0};\r\n    for(var c=1;c<this.numColumns;++c) {\r\n      this.columnIndexes[this.columnNames[c]] = c;\r\n    }\r\n\r\n    var end = new Date().getTime();\r\n    var time = end - start;\r\n    console.log('dnt process time: ' + time/1000 + 's for ' + fileName);\r\n  }\r\n  \r\n  this.getRow = function(index) {\r\n    return this.convertData(this.data[index]);\r\n  }\r\n  \r\n  this.convertData = function(d) {\r\n    var item = {id: d[0]};\r\n\r\n    for(var c=1;c<this.numColumns;++c) {\r\n      if(d[c] != null) {\r\n        item[this.columnNames[c]] = d[c];\r\n      }\r\n    }\r\n    \r\n    return item;\r\n  }\r\n  \r\n  this.getValue = function(index, colName) {\r\n    if(colName in this.columnIndexes) {\r\n      return this.data[index][this.columnIndexes[colName]];\r\n    }\r\n    else {\r\n      return null;\r\n    }\r\n  }\r\n  \r\n  // function to load in dnt data from a hosted file\r\n  // if the file is not found it will try a zip with the same name\r\n  this.loadDntFromServerFile = function(fileName, statusFunc, processFileFunc, failFunc) {\r\n    var useFileName = fileName;\r\n    if(this.colsToLoad === null && fileName.toUpperCase().lastIndexOf(\".LZJSON\") != fileName.length-7) {\r\n      useFileName = fileName.substr(0,fileName.length-4) + '.lzjson';\r\n    }\r\n    this.loadDntFromServerFileImpl(useFileName, statusFunc, processFileFunc, failFunc);\r\n  }\r\n  \r\n  this.loadDntFromServerFileImpl = function(fileName, statusFunc, processFileFunc, failFunc) {\r\n    \r\n    // console.log(\"about to load\");\r\n    var isLzJson = (fileName.toUpperCase().lastIndexOf(\".LZJSON\") == fileName.length-7);\r\n    \r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', fileName, true);\r\n    \r\n    if(isLzJson) {\r\n      xhr.responseType = 'text';\r\n    }\r\n    else {\r\n      xhr.responseType = 'blob';\r\n    }\r\n    \r\n    statusFunc('downloading dnt file ' + fileName);\r\n    var start = new Date().getTime();\r\n    \r\n    var t = this;\r\n    \r\n    xhr.onload = function(e) {\r\n      // console.log(\"got status\");\r\n      \r\n      if (this.status === 200) {\r\n        // console.log(\"got 200 status\");\r\n        \r\n        var blobv = this.response;\r\n        if(fileName.toUpperCase().lastIndexOf(\".DNT\") === fileName.length-4) {\r\n          // console.log(\"dnt file\");\r\n          \r\n          var fileReader = new FileReader();\r\n          fileReader.onload = function(e) {\r\n            t.processFile(e.target.result, fileName);\r\n            \r\n            var end = new Date().getTime();\r\n            var time = end - start;\r\n            console.log('dnt time: ' + time/1000 + 's for ' + fileName);\r\n            processFileFunc();\r\n          };\r\n          fileReader.readAsArrayBuffer(blobv);\r\n        }\r\n        else if(isLzJson) {\r\n          t.processLzFile(blobv, fileName);\r\n          \r\n          var end = new Date().getTime();\r\n          var time = end - start;\r\n          console.log('lzjson time: ' + time/1000 + 's for ' + fileName);\r\n          processFileFunc();\r\n        }\r\n        else {\r\n          // console.log(\"zip maybe\");\r\n          statusFunc('unziping compressed dnt file');\r\n          \r\n          // console.log(blobv);\r\n          \r\n          unzipBlob(blobv, function(unZippedData) {\r\n            \r\n            // statusFunc('loading dnt');\r\n            //console.log(\"unzipped: \" + unZippedData.length + \" bytes\");\r\n            \r\n            var fileReader = new FileReader();\r\n            fileReader.onload = function(e) {\r\n              t.processFile(e.target.result, fileName);\r\n            \r\n              var end = new Date().getTime();\r\n              var time = end - start;\r\n              console.log('zip time: ' + time/1000 + 's for ' + fileName);\r\n              processFileFunc();\r\n            };\r\n            fileReader.readAsArrayBuffer(unZippedData);\r\n          });\r\n        }\r\n      }\r\n      else {\r\n        // if we get an error we can try to see if there is a zip version there\r\n        if(fileName.toUpperCase().lastIndexOf('.LZJSON') === fileName.length-7) {\r\n          console.log('trying dnt');\r\n          var dntFileName = fileName.substr(0,fileName.length-7) + '.dnt';\r\n          t.loadDntFromServerFileImpl(dntFileName, statusFunc, processFileFunc, failFunc);\r\n        }\r\n        else if(fileName.toUpperCase().lastIndexOf('.DNT') === fileName.length-4) {\r\n          console.log('trying zip');\r\n          var zipFileName = fileName.substr(0,fileName.length-4) + '.zip';\r\n          t.loadDntFromServerFileImpl(zipFileName, statusFunc, processFileFunc, failFunc);\r\n        }\r\n        else {\r\n          console.log('what! status ' + this.status + '??');\r\n          failFunc(this.status + ': Cannot load file, couldnt load zip either: ' + fileName);\r\n        }\r\n      }\r\n    };\r\n    \r\n    xhr.send();\r\n  }\r\n  \r\n  this.processLzFile = function(blobv, fileName) {\r\n    var stringifiedData = LZString.decompressFromUTF16(blobv);\r\n\r\n    var dlData = JSON.parse(stringifiedData);\r\n    \r\n    this.data = dlData.data;\r\n    this.fileName = fileName;\r\n    this.columnNames = dlData.columnNames;\r\n    this.columnTypes = dlData.columnTypes;\r\n    \r\n    this.numRows = this.data.length;\r\n    this.numColumns = dlData.columnNames.length;\r\n    \r\n    this.columnIndexes = {'id': 0};\r\n    for(var c=1;c<this.numColumns;++c) {\r\n      this.columnIndexes[this.columnNames[c]] = c;\r\n    }\r\n  }\r\n  \r\n  function unzipBlob(blob, callback) {\r\n    // use a zip.BlobReader object to read zipped data stored into blob variable\r\n    zip.createReader(new zip.BlobReader(blob), function(zipReader) {\r\n      // get entries from the zip file\r\n      zipReader.getEntries(function(entries) {\r\n        // get data from the first file\r\n        entries[0].getData(new zip.BlobWriter(), function(data) {\r\n          // close the reader and calls callback function with uncompressed data as parameter\r\n          zipReader.close();\r\n          callback(data);\r\n        });\r\n      });\r\n    }, onerror);\r\n  }\r\n  \r\n  function onerror(message) {\r\n    console.error(message);\r\n  }\r\n}","function DnTranslations() {\r\n  // module used to load uistring.xml files\r\n\r\n  // the data\r\n  this.data = null;\r\n  this.sizeLimit = null;\r\n  \r\n  // function to lookup some string value by its id\r\n  // this will also work with values that have a number\r\n  // of mids enclosed in curly brackets\r\n  this.translate = function(value) {\r\n    if(this.data === null) {\r\n      return value;\r\n    }\r\n    var result = \"\";\r\n    \r\n    if(value === 0 || value === \"\" || value === null) {\r\n      result = value;\r\n    }\r\n    else if(value.toString().indexOf(',') > -1) {\r\n      var values = value.toString().split(',');\r\n      \r\n      var results = []\r\n      for(var v=0;v<values.length;++v) {\r\n        var stripped = values[v].replace(\"{\", \"\").replace(\"}\", \"\");\r\n        results.push(values[v].replace(stripped, this.translate(stripped)));\r\n      }\r\n      \r\n      result = results.join(',');\r\n    }\r\n    else {\r\n      result = this.data[value];\r\n      if(typeof result === 'undefined') {\r\n        if(typeof value === 'string') {\r\n          if(value.indexOf('{') == 0) {\r\n            var stripped = value.replace(\"{\", \"\").replace(\"}\", \"\");\r\n            result = value.replace(stripped, this.translate(stripped));\r\n          }\r\n          else {\r\n            result = value.toString();\r\n          }\r\n        }\r\n        else {\r\n          result = value;\r\n        }\r\n      }\r\n      else if(typeof value === 'string' && result.indexOf('#N/A') == 0) {\r\n        result = '';\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  }\r\n  \r\n  // function to read in the xml data\r\n  // and store it as an array for fast access\r\n  // once loaded it tries to store the data in UIStrings session storage\r\n  this.process = function(xmlFileAsString, callback, complete) {\r\n    this.data = {}\r\n    var numItems = 0;\r\n    \r\n    // console.log(\"processing:\");\r\n    var parser = new DOMParser();\r\n    var xmlData = parser.parseFromString(xmlFileAsString,\"text/xml\");\r\n    var elements = xmlData.getElementsByTagName(\"message\");\r\n    \r\n    for(var m=0;m<elements.length;++m) {\r\n      var text = elements[m].textContent;\r\n      if(this.sizeLimit === null || text.length < this.sizeLimit) {\r\n        var mid = elements[m].getAttribute(\"mid\");\r\n        this.data[mid] = text;\r\n        numItems++;\r\n      }\r\n    }\r\n  \r\n    try {\r\n      var stringifiedData = JSON.stringify(this.data);\r\n      sessionStorage.setItem('UIStrings', LZString.compressToUTF16(stringifiedData));\r\n      callback('stored ui strings for later');\r\n    }\r\n    catch (ex) {\r\n      console.log('error setting strings ' + ex);\r\n      console.log(ex.stack);\r\n    }\r\n    \r\n    callback('loaded ' + numItems + ' translations');\r\n    complete();\r\n  }\r\n  \r\n  this.loadFromSession = function() {\r\n    try {\r\n      this.data = null;\r\n      \r\n      var savedData = sessionStorage.getItem('UIStrings'); \r\n      if(savedData === null) {\r\n        return false;\r\n      }\r\n      \r\n      var stringifiedData = LZString.decompressFromUTF16(savedData);\r\n      this.data = JSON.parse(stringifiedData);\r\n      console.log('got ui strings from local storage');\r\n      return true;\r\n    }\r\n    catch(ex) {\r\n      console.log('couldnt get ui strings ' + ex);\r\n      // no worries, just load the default\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  // function to load xml file from url\r\n  // if the file is not found we look for a zip verison and then unzip it\r\n  // it tries to find the already loaded data in UIStrings session storage\r\n  // and uses this if it can\r\n  this.loadDefaultFile = function(fileName, callback, complete, fail) {\r\n    // console.log(\"about to load\");\r\n    \r\n    this.loadFromSession();\r\n    \r\n    if(this.data != null && typeof this.data === 'object') {\r\n      callback('using uistrings stored in local storage');\r\n      complete();\r\n    }\r\n    else if(fileName === null) {\r\n      callback('Translation location required');\r\n    }\r\n    else {\r\n      console.log('data still not set');\r\n      \r\n      localStorage.setItem('UIStrings_file', fileName);\r\n    \r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('GET', fileName, true);\r\n      if(fileName.toUpperCase().lastIndexOf('.ZIP') === fileName.length-4) {\r\n        xhr.responseType = 'blob';\r\n      }\r\n      else if(fileName.toUpperCase().lastIndexOf('.XML') === fileName.length-4) {\r\n        xhr.responseType = 'document';\r\n      }\r\n      else {\r\n        xhr.responseType = 'text';\r\n      }\r\n      \r\n      callback('downloading translation file ' + fileName);\r\n      \r\n      var t = this;\r\n      \r\n      xhr.onload = function(e) {\r\n        \r\n        if (this.status === 200) {\r\n          \r\n          callback('loading translations from ' + fileName);\r\n          var start = new Date().getTime();\r\n          \r\n          var blobv = this.response;\r\n          \r\n          console.log(\"reading zip\");\r\n          if(fileName.toUpperCase().lastIndexOf('.LZJSON') === fileName.length-7) {\r\n            sessionStorage.setItem('UIStrings', blobv);\r\n            t.loadFromSession();\r\n            callback('using lzjson translations');\r\n            complete();\r\n            \r\n            var end = new Date().getTime();\r\n            var time = end - start;\r\n            console.log('translations process time: ' + time/1000 + 's');\r\n          }\r\n          else if(fileName.toUpperCase().lastIndexOf('.ZIP') === fileName.length-4) {\r\n            unzipBlobToText(blobv, function(unZippedData) {\r\n              console.log('got entry data');\r\n              callback('loading xml');\r\n              console.log(\"unzipped: \" + unZippedData.length.toLocaleString() + \" bytes\");\r\n              t.process(unZippedData, callback, complete);\r\n            \r\n            var end = new Date().getTime();\r\n            var time = end - start;\r\n              console.log('translations process time: ' + time/1000 + 's');\r\n            });\r\n          }\r\n          else if(fileName.toUpperCase().lastIndexOf('.XML') === fileName.length-4) {\r\n            callback('using xml translations');\r\n            t.process(blobv, callback, complete);\r\n            \r\n            var end = new Date().getTime();\r\n            var time = end - start;\r\n            console.log('translations process time: ' + time/1000 + 's');\r\n          }\r\n          \r\n        }\r\n        else {\r\n          // if we get an error we can try to see if there is a zip version there\r\n          if(fileName.toUpperCase().lastIndexOf('.LZJSON') === fileName.length-7) {\r\n            var baseFileName = fileName.substr(0,fileName.length-7);\r\n            t.loadDefaultFile(baseFileName + '.zip', callback, complete, fail);\r\n          }\r\n          else if(fileName.toUpperCase().lastIndexOf('.ZIP') === fileName.length-4) {\r\n            var baseFileName = fileName.substr(0,fileName.length-4);\r\n            t.loadDefaultFile(baseFileName + '.xml', callback, complete, fail);\r\n          }\r\n          else {\r\n            console.log('what status' + this.status + ' ' + fileName);\r\n            fail(this.status + ': Cannot load file, couldnt load zip either: ' + fileName);\r\n          }\r\n        }\r\n      };\r\n      \r\n      xhr.send();\r\n    }\r\n  }\r\n\r\n  function unzipBlobToText(blob, callback) {\r\n    // use a zip.BlobReader object to read zipped data stored into blob variable\r\n    zip.createReader(new zip.BlobReader(blob), function(zipReader) {\r\n      // get entries from the zip file\r\n      zipReader.getEntries(function(entries) {\r\n        // get data from the first file\r\n        entries[0].getData(new zip.TextWriter(\"text/plain\"), function(data) {\r\n          // close the reader and calls callback function with uncompressed data as parameter\r\n          zipReader.close();\r\n          callback(data);\r\n        });\r\n      });\r\n    }, onerror);\r\n  }\r\n  \r\n  function onerror(message) {\r\n    console.error(message);\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}