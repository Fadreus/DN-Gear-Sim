<div class="row" ng-hide="anyItems">
  <div class="col-xs-12">
    <h3>nothing saved</h3>
    <p>maybe <a href="#/item-search">search</a> for some items?</p>
  </div>
</div>
<div class="row" ng-show="isLoading">
  <div class="col-xs-12 loading">
    loading...
  </div>
</div>
<div id="savedGroup" class="row" ng-show="anyItems" ng-repeat="(groupName, items) in savedItems track by $index" ng-hide="isLoading">
  <div class="col-xs-12 group-header" ng-show="currentGroup != groupName">
    <button class="btn btn-link btn-block" ng-click="$parent.setCurrentGroup(groupName)">
      <h3 class="text-left">{{groupName}}
      <small>
        <span ng-show="items.playerLevel > 0">lv{{items.playerLevel}}</span>
        <span ng-show="items.job && items.job.id > 0">{{items.job.name}}</span></br>
        {{$parent.getSaveDate(groupName)}} {{$parent.getSaveTime(groupName)}}<br />
        {{$parent.getGroupSummary(groupName)}}<br />
        {{$parent.getSummaryStats(groupName)}}
      </small></h3>
    </button>
  </div>
  <div class="col-xs-12 col-md-2 group-header" ng-hide="currentGroup != groupName">
    <div class="row">
      <div class="col-xs-12 col-md-12" ng-click="$parent.setCurrentGroup('')">
        <button class="btn btn-link btn-block">
          <h3 class="text-left">{{groupName}}<br class="hidden-xs hidden-sm" />
          <small>
            <span ng-show="items.playerLevel > 0">lv{{items.playerLevel}}&nbsp;</span>
            <span ng-show="items.job && items.job.id > 0">{{items.job.name}}<br /></span>
            {{$parent.getSaveDate(groupName)}}<br />
            {{$parent.getSaveTime(groupName)}}
          </small>
          </h3>
        </button>
      </div>
      <div class="col-xs-6 col-md-12">
        <button class="btn btn-link" ng-click="$parent.createShortUrl(groupName)" ng-hide="items.shortUrl != null">create permalink</button>
        <a class="btn btn-link" href="{{items.shortUrl}}" ng-show="items.shortUrl != null">{{items.shortUrl}}</a>
      </div>
      <div class="col-xs-6 col-md-12">
        <button class="btn btn-link" ng-click="$parent.copyGroup(groupName)">copy</button> | 
        <button class="btn btn-link" ng-click="$parent.editGroup(items, groupName)">edit</button> | 
        <button class="btn btn-link" ng-click="$parent.reloadGroup(groupName)">reload</button>
      </div>
      <div class="col-xs-6 col-md-hide" ng-show="$parent.calculatedStats[groupName].length == 0">
      </div>
      <div class="col-xs-10 text-right col-md-12 bg-danger" ng-show="$parent.calculatedStats[groupName].length == 0 || $parent.nakedStats[groupName].length == 0">
        use the edit link to set level and class
      </div>
      <div class="col-xs-3 col-md-12" ng-show="$parent.calculatedStats[groupName].length > 0">
        <h4>calculated stats</h4>
        <div dnsim-stats stats="$parent.calculatedStats[groupName]"></div>
      </div>
      <div class="col-xs-3 col-md-12" ng-show="$parent.nakedStats[groupName].length > 0">
        <h4>naked stats</h4>
        <div dnsim-stats stats="$parent.nakedStats[groupName]"></div>
      </div>
      <div class="col-xs-6 col-md-12">
        <h4>combined&nbsp;stats</h4>
        <div class="row">
          <div class="col-xs-6 col-md-12" dnsim-stats stats="$parent.combinedStats[groupName]"></div>
        </div>
      </div>
    </div>
    <div class="row">&nbsp;</div>
  </div>
  <div class="col-xs-12 col-md-10" ng-hide="currentGroup != groupName">
    <br />
    <div class="row item-type-grouping" ng-repeat="(typeName,typeItems) in $parent.savedItemsByType[groupName] track by $index">
      <table class="table">
        <tr>
          <th>
            {{typeName}} <span style="float: right"><a href="#/item-search/{{typeName}}">search</a></span>
          </th>
        </tr>
        <tr ng-repeat="result in typeItems | orderBy:'name' | orderBy:'-levelLimit' track by $index">
          <td>
            <div>
              <dnsim-item-link item="result" on-close="$parent.closeItemLink(groupName)" />
            </div>
            <div>
              <span dnsim-stats stats="result.fullStats" alt-stats="result.stats" separator="'|'" />
            </div>
            <div>
                <button class="btn btn-link" ng-click="$parent.$parent.addItem(groupName, result);">re-use</button>
                <button class="btn btn-link" ng-click="$parent.$parent.removeItem(groupName, result);">remove</button>
            </div>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
